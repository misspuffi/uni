(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user-pages-channel-poster~user-pages-coupon-poster~user-pages-distribution-bind-technician~user-page~6f2d85f5"],{"0c9d":function(e,t,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.base64ToPath=function(e){var t=/^data:image\/(\w+);base64,/.exec(e)||[],n=(0,c.default)(t,2);n[1];return new Promise((function(t,n){for(var a=e.split(",")[0].split(":")[1].split(";")[0],i=atob(e.split(",")[1]),r=new ArrayBuffer(i.length),s=new Uint8Array(r),c=0;c<i.length;c++)s[c]=i.charCodeAt(c);t(URL.createObjectURL(new Blob([s],{type:a})))}))},t.compareVersion=function(e,t){e=e.split("."),t=t.split(".");var n=Math.max(e.length,t.length);while(e.length<n)e.push("0");while(t.length<n)t.push("0");for(var a=0;a<n;a++){var i=parseInt(e[a],10),r=parseInt(t[a],10);if(i>r)return 1;if(i<r)return-1}return 0},t.downloadFile=function(e){return e?new Promise((function(t,n){if(o[e])return n();o[e]=1,uni.downloadFile({url:e,success:function(e){t(e)},fail:function(e){n(e)}})})):Promise.reject({err:"no url"})},t.getImageInfo=function(e,t){return new Promise(function(){var n=(0,s.default)((0,i.default)().mark((function n(a,s){var c;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(c=e,!o[e]||!o[e].errMsg){n.next=5;break}a(o[e]),n.next=16;break;case 5:if(n.prev=5,!t){n.next=10;break}return n.next=9,l(e);case 9:c=n.sent;case 10:n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](5),s((0,r.default)((0,r.default)({},n.t0),{},{src:c}));case 15:uni.getImageInfo({src:c,success:function(t){t.path=t.path.replace(/^\./,window.location.origin),u?a(t):(o[e]=t,a(o[e]))},fail:function(t){s({err:t,path:e})}});case 16:case"end":return n.stop()}}),n,null,[[5,12]])})));return function(e,t){return n.apply(this,arguments)}}())},t.isBase64=void 0,t.isNumber=d,t.networkReg=void 0,t.pathToBase64=l,t.sleep=function(e){return new Promise((function(t){return setTimeout(t,e)}))},t.toPx=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"===typeof t)return t;if(d(t))return 1*t;if("string"===typeof t){var i=/^-?([0-9]+)?([.]{1}[0-9]+){0,1}(em|rpx|px|%)$/g,r=i.exec(t);if(!t||!r)return 0;var s=r[3];t=parseFloat(t);var c=0;return"rpx"===s?c=uni.upx2px(t):"px"===s?c=1*t:"%"===s?c=t*e(n)/100:"em"===s&&(c=t*e(n||14)),a?1*c.toFixed(2):Math.round(c)}return 0};var i=a(n("c7eb")),r=a(n("5530")),s=a(n("1da1")),c=a(n("3835"));n("ac1f"),n("00b4"),n("d3b7"),n("caad"),n("acd8"),n("14d9"),n("e25e"),n("c19f"),n("ace4"),n("c975"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("986a"),n("1d02"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("b39a"),n("72f7"),n("5319"),n("d401"),n("81b2"),n("0eb6"),n("b7ef"),n("8bd4"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861");t.networkReg=/^(http|\/\/)/;t.isBase64=function(e){return/^data:image\/(\w+);base64/.test(e)};var u=["devtools"].includes(uni.getSystemInfoSync().platform),o={};function d(e){return/^-?\d+(\.\d+)?$/.test(e)}function l(e){return/^data:/.test(e)?e:new Promise((function(t,n){var a=new Image;a.setAttribute("crossOrigin","Anonymous"),a.onload=function(){var e=document.createElement("canvas");e.width=this.naturalWidth,e.height=this.naturalHeight,e.getContext("2d").drawImage(a,0,0);var n=e.toDataURL("image/png");t(n),e.height=e.width=0},a.src=e+"?v="+Math.random(),a.onerror=function(e){n(e)}}))}},"546d":function(e,t,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("c7eb")),r=a(n("1da1"));n("99af"),n("b64b"),n("e9c4"),n("d3b7"),n("ac1f"),n("d9e2"),n("d401"),n("5319");var s=n("a61d"),c=a(n("b7c5")),u=n("0c9d"),o=a(n("b356")),d={name:"lime-painter",mixins:[c.default,(0,s.parent)("painter"),{}],data:function(){return{use2dCanvas:!1,canvasHeight:150,canvasWidth:null,parentWidth:0,inited:!1,progress:0,firstRender:0,done:!1}},computed:{styles:function(){return"".concat(this.size).concat(this.customStyle||"",";")},canvasId:function(){return"l-painter".concat(this._uid||this._.uid)},size:function(){if(this.boardWidth&&this.boardHeight)return"width:".concat(this.boardWidth,"px; height: ").concat(this.boardHeight,"px;")},dpr:function(){return this.pixelRatio||uni.getSystemInfoSync().pixelRatio},boardWidth:function(){var e=this.elements&&this.elements.css||this.elements||this,t=e.width,n=void 0===t?0:t,a=(0,u.toPx)(n||this.width);return a||Math.max(a,(0,u.toPx)(this.canvasWidth))},boardHeight:function(){var e=this.elements&&this.elements.css||this.elements||this,t=e.height,n=void 0===t?0:t,a=(0,u.toPx)(n||this.height);return a||Math.max(a,(0,u.toPx)(this.canvasHeight))},hasBoard:function(){return this.board&&Object.keys(this.board).length},elements:function(){return JSON.parse(JSON.stringify(this.hasBoard?this.board:this.el))}},watch:{},created:function(){var e=uni.getSystemInfoSync();e.SDKVersion,e.version,e.platform},mounted:function(){var e=this;return(0,r.default)((0,i.default)().mark((function t(){return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,u.sleep)(30);case 2:return t.next=4,e.getParentWeith();case 4:e.$nextTick((function(){setTimeout((function(){e.$watch("elements",e.watchRender,{deep:!0,immediate:!0})}),30)}));case 5:case"end":return t.stop()}}),t)})))()},methods:{watchRender:function(e,t){var n=this;return(0,r.default)((0,i.default)().mark((function a(){return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e&&e.views&&(n.firstRender?n.firstRender:e.views.length)&&Object.keys(e).length&&e!=t){a.next=2;break}return a.abrupt("return");case 2:n.firstRender=1,clearTimeout(n.rendertimer),n.rendertimer=setTimeout((function(){n.render(e)}),n.beforeDelay);case 5:case"end":return a.stop()}}),a)})))()},setFilePath:function(e,t){var n=this;return(0,r.default)((0,i.default)().mark((function a(){var r,s,c,o;return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e,s=t||n,c=s.pathType,o=void 0===c?n.pathType:c,"base64"!=o||(0,u.isBase64)(e)){a.next=8;break}return a.next=5,(0,u.pathToBase64)(e);case 5:r=a.sent,a.next=12;break;case 8:if("url"!=o||!(0,u.isBase64)(e)){a.next=12;break}return a.next=11,(0,u.base64ToPath)(e);case 11:r=a.sent;case 12:return t&&t.isEmit&&n.$emit("success",r),a.abrupt("return",r);case 14:case"end":return a.stop()}}),a)})))()},getSize:function(e){var t=this;return(0,r.default)((0,i.default)().mark((function n(){var a,r,s,c;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.css||e,r=a.width,s=e.css||e,c=s.height,t.size){n.next=12;break}if(!r&&!c){n.next=10;break}return t.canvasWidth=r||t.canvasWidth,t.canvasHeight=c||t.canvasHeight,n.next=8,(0,u.sleep)(30);case 8:n.next=12;break;case 10:return n.next=12,t.getParentWeith();case 12:case"end":return n.stop()}}),n)})))()},canvasToTempFilePathSync:function(e){var t=this;this.stopWatch=this.$watch("done",(function(n){n&&(t.canvasToTempFilePath(e),t.stopWatch&&t.stopWatch())}),{immediate:!0})},getParentWeith:function(){var e=this;return new Promise((function(t){uni.createSelectorQuery().in(e).select(".lime-painter").boundingClientRect().exec((function(n){var a=n[0]||{},i=a.width,r=a.height;e.parentWidth=Math.ceil(i||0),e.canvasWidth=e.parentWidth||300,e.canvasHeight=r||e.canvasHeight||150,t(n[0])}))}))},render:function(){var e=arguments,t=this;return(0,r.default)((0,i.default)().mark((function n(){var a,r,s,c,d,l,f,h,p,v,b,m,g,x;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:{},Object.keys(a).length){n.next=3;break}return n.abrupt("return",console.error("空对象"));case 3:return t.progress=0,t.done=!1,n.next=7,t.getSize(a);case 7:return n.next=9,t.getContext();case 9:if(r=n.sent,s=t.use2dCanvas,c=t.boardWidth,d=t.boardHeight,l=t.canvas,f=t.afterDelay,!s||l){n.next=13;break}return n.abrupt("return",Promise.reject(new Error("render: fail canvas has not been created")));case 13:return t.boundary={top:0,left:0,width:c,height:d},t.painter=null,t.painter||(h=a.css||a,p=h.width,v=a.css||a,v.height,!p&&t.parentWidth&&Object.assign(a,{width:t.parentWidth}),b={context:r,canvas:l,width:c,height:d,pixelRatio:t.dpr,useCORS:t.useCORS,listen:{onProgress:function(e){t.progress=e,t.$emit("progress",e)},onEffectFail:function(e){t.$emit("faill",e)}}},s||(b.createImage=u.getImageInfo),t.painter=new o.default(b,t)),n.next=18,t.painter.source(JSON.parse(JSON.stringify(a)));case 18:return m=n.sent,g=m.width,x=m.height,t.boundary.height=t.canvasHeight=x,t.boundary.width=t.canvasWidth=g,n.next=25,(0,u.sleep)(t.sleep);case 25:return s||t.painter.init(t.ctx),n.next=28,t.painter.render();case 28:return n.next=30,new Promise((function(e){return t.$nextTick(e)}));case 30:if(s){n.next=33;break}return n.next=33,t.canvasDraw();case 33:if(!f||!s){n.next=36;break}return n.next=36,(0,u.sleep)(f);case 36:return t.$emit("done"),t.done=!0,t.isCanvasToTempFilePath&&t.canvasToTempFilePath().then((function(e){t.$emit("success",e.tempFilePath)})).catch((function(e){t.$emit("fail",new Error(JSON.stringify(e)))})),n.abrupt("return",Promise.resolve({ctx:r,draw:t.painter,node:t.node}));case 40:case"end":return n.stop()}}),n)})))()},canvasDraw:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(n,a){return e.ctx.draw(t,(function(){return setTimeout((function(){return n()}),e.afterDelay)}))}))},getContext:function(){var e=this;return(0,r.default)((0,i.default)().mark((function t(){var n,a,r;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.canvasWidth){t.next=4;break}return e.$emit("fail","painter no size"),console.error("painter no size: 请给画板或父级设置尺寸"),t.abrupt("return",Promise.reject());case 4:if(!e.ctx||!e.inited){t.next=6;break}return t.abrupt("return",Promise.resolve(e.ctx));case 6:if(n=e.type,a=e.use2dCanvas,e.dpr,e.boardWidth,e.boardHeight,r=function(){return new Promise((function(t){uni.createSelectorQuery().in(e).select("#".concat(e.canvasId)).boundingClientRect().exec((function(n){if(n){var a=uni.createCanvasContext(e.canvasId,e);e.inited||(e.inited=!0,e.use2dCanvas=!1,e.canvas=n),e.ctx=a,t(e.ctx)}}))}))},a){t.next=10;break}return t.abrupt("return",r());case 10:return t.abrupt("return",new Promise((function(t){uni.createSelectorQuery().in(e).select("#".concat(e.canvasId)).node().exec((function(a){var i=a[0].node;i||(e.use2dCanvas=!1,t(e.getContext()));var r=i.getContext(n);e.inited||(e.inited=!0,e.use2dCanvas=!0,e.canvas=i),e.ctx=r,t(e.ctx)}))})));case 11:case"end":return t.stop()}}),t)})))()},canvasToTempFilePath:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(){var n=(0,r.default)((0,i.default)().mark((function n(a,s){var c,u,o,d,l,f,h,p,v,b,m,g,x,w,y,P,k;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(c=e.use2dCanvas,u=e.canvasId,o=e.dpr,d=e.fileType,l=e.quality,f=function(){var t=(0,r.default)((0,i.default)().mark((function t(n){var r;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.setFilePath(n.tempFilePath||n);case 3:r=t.sent,a(Object.assign(n,{tempFilePath:r})),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.$emit("fail",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),h=e.boundary||e,p=h.top,v=void 0===p?0:p,b=h.left,m=void 0===b?0:b,g=h.width,x=h.height,w=g*o,y=x*o,P=Object.assign({x:m,y:v,width:g,height:x,destWidth:w,destHeight:y,canvasId:u,fileType:d,quality:l,success:f,fail:s},t),!c){n.next=22;break}return n.prev=7,t.pathType||e.pathType||(t.pathType="url"),n.next=11,e.setFilePath(e.canvas.toDataURL("image/".concat(t.fileType||d).replace(/pg/,"peg"),t.quality||l),t);case 11:k=n.sent,t.success&&t.success({tempFilePath:k}),a({tempFilePath:k}),n.next=20;break;case 16:n.prev=16,n.t0=n["catch"](7),t.fail&&t.fail(n.t0),s(n.t0);case 20:n.next=23;break;case 22:uni.canvasToTempFilePath(P,e);case 23:case"end":return n.stop()}}),n,null,[[7,16]])})));return function(e,t){return n.apply(this,arguments)}}())}}};t.default=d},"60eb":function(e,t,n){var a=n("6165");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("4f06").default;i("793f7be8",a,!0,{sourceMap:!1,shadowMode:!1})},6165:function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,".lime-painter[data-v-85188b92],\n.lime-painter__canvas[data-v-85188b92]{\nwidth:100%;\n}",""]),e.exports=t},8621:function(e,t,n){"use strict";n.r(t);var a=n("546d"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t["default"]=i.a},a61d:function(e,t,n){"use strict";var a=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.children=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.indexKey;return{inject:(0,s.default)({},e,{default:null}),watch:{el:{handler:function(e,t){JSON.stringify(e)!=JSON.stringify(t)&&this.bindRelation()},deep:!0,immediate:!0},src:{handler:function(e,t){e!=t&&this.bindRelation()},immediate:!0},text:{handler:function(e,t){e!=t&&this.bindRelation()},immediate:!0},css:{handler:function(e,t){e!=t&&(this.el.css=("object"==(0,r.default)(e)?e:e&&Object.assign.apply(Object,(0,i.default)(c(e))))||{})},immediate:!0},replace:{handler:function(e,t){JSON.stringify(e)!=JSON.stringify(t)&&this.bindRelation()},deep:!0,immediate:!0}},created:function(){var t=this;this._uid||(this._uid=this._.uid),Object.defineProperty(this,"parent",{get:function(){return t[e]||[]}}),Object.defineProperty(this,"index",{get:function(){t.bindRelation();var e=t.parent;e=void 0===e?{}:e;var n=e.el;n=void 0===n?{}:n;var a=n.views,i=void 0===a?[]:a;return i.indexOf(t.el)}}),this.el.type=this.type,this.bindRelation()},beforeDestroy:function(){this.removeEl()},methods:{removeEl:function(){var e=this;this.parent&&(this.parent.el.views=this.parent.el.views.filter((function(t){return t._uid!==e._uid})))},bindRelation:function(){var e=this;if(this.el._uid||(this.el._uid=this._uid),["text","qrcode"].includes(this.type)&&(this.el.text=this.$slots&&this.$slots.default&&this.$slots.default[0].text||"".concat(this.text||"").replace(/\\n/g,"\n")),"image"==this.type&&(this.el.src=this.src),this.parent){var t=this.parent.el.views||[];-1!==t.indexOf(this.el)?this.parent.el.views=t.map((function(t){return t._uid==e._uid?e.el:t})):this.parent.el.views=[].concat((0,i.default)(t),[this.el])}}},mounted:function(){}}},t.parent=function(e){return{provide:function(){return(0,s.default)({},e,this)},data:function(){return{el:{css:{},views:[]}}},watch:{css:{handler:function(e){this.canvasId&&(this.el.css=("object"==(0,r.default)(e)?e:e&&Object.assign.apply(Object,(0,i.default)(c(e))))||{},this.canvasWidth=this.el.css&&this.el.css.width||this.canvasWidth,this.canvasHeight=this.el.css&&this.el.css.height||this.canvasHeight)},immediate:!0}}}};var i=a(n("2909")),r=a(n("53ca")),s=a(n("ade3"));n("d81d"),n("4de4"),n("d3b7"),n("ac1f"),n("00b4"),n("fb6a"),n("c975"),n("5319"),n("e9c4"),n("7a82"),n("caad"),n("99af");var c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split(";").filter((function(e){return e&&!/^[\n\s]+$/.test(e)})).map((function(e){var t=e.slice(0,e.indexOf(":")),n=e.slice(e.indexOf(":")+1);return(0,s.default)({},t.replace(/-([a-z])/g,(function(){return arguments[1].toUpperCase()})).replace(/\s+/g,""),n.replace(/^\s+/,"").replace(/\s+$/,"")||"")}))}},b7c5:function(e,t,n){"use strict";n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("a9e3");var a={props:{board:Object,pathType:String,fileType:{type:String,default:"png"},quality:{type:Number,default:1},css:[String,Object],width:[Number,String],height:[Number,String],pixelRatio:Number,customStyle:String,isCanvasToTempFilePath:Boolean,sleep:{type:Number,default:1e3/30},beforeDelay:{type:Number,default:100},afterDelay:{type:Number,default:100},useCORS:Boolean}};t.default=a},ea66:function(e,t,n){"use strict";var a=n("60eb"),i=n.n(a);i.a},eb09:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{ref:"limepainter",staticClass:"lime-painter"},[e.canvasId&&e.size?n("v-uni-view",{style:e.styles},[e.use2dCanvas?n("v-uni-canvas",{staticClass:"lime-painter__canvas",style:e.size,attrs:{id:e.canvasId,type:"2d"}}):n("v-uni-canvas",{staticClass:"lime-painter__canvas",style:e.size,attrs:{"canvas-id":e.canvasId,id:e.canvasId,width:e.boardWidth*e.dpr,height:e.boardHeight*e.dpr}})],1):e._e(),e._t("default")],2)},i=[]},f300:function(e,t,n){"use strict";n.r(t);var a=n("eb09"),i=n("8621");for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n("ea66");var s=n("f0c5"),c=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"85188b92",null,!1,a["a"],void 0);t["default"]=c.exports}}]);