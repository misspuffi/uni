(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user-pages-bell-list"],{"0543":function(e,t,i){var n=i("fab1");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("6f9c8b69",n,!0,{sourceMap:!1,shadowMode:!1})},"6c33":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isLoad?i("v-uni-view",{staticClass:"pages-user-bell"},[e.can_add_order?i("fixed",[i("tab",{attrs:{list:e.tabList,activeIndex:1*e.activeIndex,activeColor:e.primaryColor,width:"50%",height:"100rpx"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handerTabChange.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"b-1px-b"})],1):e._e(),0==e.activeIndex&&e.have_check.length>0?i("v-uni-view",{staticClass:"pt-lg pl-lg pr-lg"},[i("v-uni-view",{staticClass:"f-desc c-paragraph text-bold"},[e._v("已选择项目")]),e._l(e.have_check,(function(t,n){return[i("v-uni-view",{key:n+"_0",staticClass:"list-item pd-lg fill-base radius-16",class:[{"mt-lg":0==n},{"mt-md":0!=n}]},[i("v-uni-view",{staticClass:"flex-center"},[i("v-uni-view",{staticClass:"cover radius-16"},[i("v-uni-view",{staticClass:"h5-image cover radius-16",style:{backgroundImage:"url('"+t.cover+"')"}})],1),i("v-uni-view",{staticClass:"flex-1 ml-md",staticStyle:{"max-width":"456rpx"}},[i("v-uni-view",{staticClass:"flex-between"},[i("v-uni-view",{staticClass:"f-title c-title text-bold ellipsis",staticStyle:{"max-width":"250rpx"}},[e._v(e._s(t.title))]),i("v-uni-view",{staticClass:"flex-warp"},[i("v-uni-button",{staticClass:"reduce",style:{borderColor:e.primaryColor,color:e.primaryColor},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.changeNum(-1,n)}}},[i("i",{staticClass:"iconfont icon-jian-bold"})]),i("v-uni-button",{staticClass:"addreduce clear-btn"},[e._v(e._s(t.init_add_num||0))]),i("v-uni-button",{staticClass:"add",style:{background:e.primaryColor,borderColor:e.primaryColor},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.changeNum(1,n)}}},[i("i",{staticClass:"iconfont icon-jia-bold"})])],1)],1),i("v-uni-view",{staticClass:"flex-warp mt-sm"},[i("v-uni-view",{staticClass:"time-long flex-center"},[e._v(e._s(t.time_long)+"分钟")]),i("v-uni-view",{staticClass:"f-caption c-caption"},[e._v(e._s(t.total_sale)+"人已预约")])],1),i("v-uni-view",{staticClass:"flex-between mt-md"},[i("v-uni-view",{staticClass:"flex-y-baseline"},[i("v-uni-view",{staticClass:"flex-y-baseline f-icontext c-warning ml-sm mr-sm"},[e._v("¥"),i("v-uni-view",{staticClass:"f-sm-title"},[e._v(e._s(t.price))])],1),e.activeIndex?e._e():i("v-uni-view",{staticClass:"flex-y-baseline f-caption c-paragraph"},[e._v("需补差价:"),i("v-uni-view",{staticClass:"c-warning"},[e._v("¥"+e._s(t.init_add_price))])],1)],1),i("v-uni-view",{staticClass:"remove-btn flex-center f-caption radius",style:{color:e.primaryColor,border:"1rpx solid "+e.primaryColor},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.toAddDelItem(2,n)}}},[e._v("移除")])],1)],1)],1),i("v-uni-view",{staticClass:"flex-between f-desc mt-lg pt-lg b-1px-t",staticStyle:{color:"#2E3541"}},[i("v-uni-view",{staticClass:"flex-y-center"},[e._v(e._s(e._f("textFormat")(t.order_goods_name)))]),i("v-uni-view",{staticClass:"shengji-icon-text flex-1 flex-center flex-column",style:{color:e.primaryColor}},[i("v-uni-view",{staticClass:"f-icontext"},[e._v("升级为")]),i("i",{staticClass:"iconfont iconshengji"})],1),i("v-uni-view",{staticClass:"flex-y-center"},[e._v(e._s(e._f("textFormat")(t.title)))])],1)],1)]}))],2):e._e(),1==e.activeIndex?i("v-uni-view",{staticClass:"pd-md"},[i("v-uni-view",{staticClass:"flex-y-center f-title c-title text-bold"},[e._v("选择加钟项目")])],1):e._e(),0===e.activeIndex?i("v-uni-view",{staticClass:"flex-center pt-lg pb-sm pl-lg pr-lg fill-base mt-md rel"},[i("v-uni-view",{staticClass:"flex-1 flex-y-center f-title c-title text-bold"},[e._v("将"),i("v-uni-view",{style:{color:e.primaryColor}},[e._v(e._s(e._f("textFormat")(e.order_goods[e.goodsInd].goods_name)))]),e._v("升级为以下项目")],1),i("v-uni-view",{staticClass:"change-btn flex-center radius",style:{color:e.primaryColor,border:"1rpx solid "+e.primaryColor},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.showGoods=!e.showGoods}}},[e._v("切换项目"),i("i",{staticClass:"iconfont",class:[{"icon-up-fill":e.showGoods},{"icon-down-fill":!e.showGoods}]})]),e.showGoods?i("v-uni-view",{staticClass:"change-goods-info pd-md abs"},e._l(e.order_goods,(function(t,n){return i("v-uni-view",{key:n,staticClass:"goods-title flex-y-center",class:[{"c-title":e.goodsInd!=n},{"c-base cur":e.goodsInd==n}],style:{background:e.goodsInd==n?e.primaryColor:"",borderColor:e.goodsInd==n?e.primaryColor:""},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.toChangeGoods(n)}}},[e._v(e._s(t.goods_name))])})),1):e._e()],1):e._e(),i("v-uni-view",{class:[{"pl-lg pr-lg fill-base":0==e.activeIndex}]},[e._l(e.serviceList,(function(t,n){return[0==e.activeIndex&&!t.is_check||1==e.activeIndex?i("v-uni-view",{key:n+"_0",staticClass:"list-item flex-center",class:[{"pt-lg pb-lg":0==e.activeIndex},{"ml-md mr-md pd-lg fill-base radius-16":1==e.activeIndex},{"b-1px-t":0!=n&&t.id!=e.no_check_id&&0==e.activeIndex},{"mt-md":0!=n&&1==e.activeIndex}],on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.toAddDelItem(1,n)}}},[i("i",{staticClass:"iconfont",class:[{"icon-xuanze":!t.is_check},{"icon-xuanze-fill":t.is_check}],style:{color:t.is_check?e.primaryColor:"#999"}}),i("v-uni-view",{staticClass:"flex-center flex-1 ml-md"},[i("v-uni-view",{staticClass:"cover radius-16"},[i("v-uni-view",{staticClass:"h5-image cover radius-16",style:{backgroundImage:"url('"+t.cover+"')"}})],1),i("v-uni-view",{staticClass:"flex-1 ml-md",style:{maxWidth:0==e.activeIndex?"456rpx":"416rpx"}},[i("v-uni-view",{staticClass:"flex-between"},[i("v-uni-view",{staticClass:"f-title c-title text-bold ellipsis",staticStyle:{"max-width":"250rpx"}},[e._v(e._s(t.title))]),i("v-uni-view",{staticClass:"f-caption c-caption"},[e._v(e._s(t.total_sale)+"人已预约")])],1),i("v-uni-view",{staticClass:"flex-between mt-sm"},[i("v-uni-view",{staticClass:"time-long flex-center"},[e._v(e._s(t.time_long)+"分钟")]),i("v-uni-view")],1),i("v-uni-view",{staticClass:"flex-center mt-md"},[i("v-uni-view",{staticClass:"flex-1 flex-y-baseline f-icontext c-warning ml-sm mr-sm"},[e._v("¥"),i("v-uni-view",{staticClass:"f-sm-title"},[e._v(e._s(t.price))])],1),0==e.activeIndex?i("v-uni-view",{staticClass:"flex-y-center f-paragraph c-paragraph"},[e._v("需补差价"),i("v-uni-view",{staticClass:"c-warning"},[e._v("¥"+e._s(t.init_add_price))])],1):e._e()],1)],1)],1)],1):e._e()]})),e.have_all_check||0==e.serviceList.length?i("v-uni-view",{staticClass:"space-md"}):e._e()],2),!e.loading&&0==e.serviceList.length||0==e.activeIndex&&e.have_all_check?i("abnor"):e._e(),i("v-uni-view",{staticClass:"space-max-footer"}),i("fix-bottom-button",{attrs:{text:[{text:"暂不"+e.navTitle,type:"cancel"},{text:"下单",type:"confirm",isAuth:!0}],bgColor:"#fff",classType:2},on:{cancel:function(t){arguments[0]=t=e.$handleEvent(t),e.$util.goUrl({url:1,openType:"navigateBack"})},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.toOrder.apply(void 0,arguments)}}})],1):e._e()},a=[]},"834f":function(e,t,i){"use strict";var n=i("0543"),a=i.n(n);a.a},a306:function(e,t,i){"use strict";i.r(t);var n=i("6c33"),a=i("c8b1");for(var s in a)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(s);i("834f");var r=i("f0c5"),c=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"4f35e31c",null,!1,n["a"],void 0);t["default"]=c.exports},c8b1:function(e,t,i){"use strict";i.r(t);var n=i("fb22"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(s);t["default"]=a.a},fab1:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.pages-user-bell .change-goods-info[data-v-4f35e31c]{top:%?89?%;right:%?30?%;min-width:%?218?%;min-height:%?280?%;max-height:%?500?%;overflow-y:auto;background:#fff;box-shadow:0 6px 16px 0 hsla(0,0%,87.1%,.37);border-radius:16px;border:1px solid #f5f5f5;z-index:99999}.pages-user-bell .change-goods-info .goods-title[data-v-4f35e31c]{font-size:%?20?%;margin:%?15?% 0}.pages-user-bell .change-goods-info .cur[data-v-4f35e31c]{height:%?36?%;padding:0 %?9?%;border-radius:%?4?%}.pages-user-bell .list-item .icon-xuanze[data-v-4f35e31c],\n.pages-user-bell .list-item .icon-xuanze-fill[data-v-4f35e31c]{font-size:%?40?%}.pages-user-bell .list-item .cover[data-v-4f35e31c]{width:%?155?%;height:%?155?%}.pages-user-bell .list-item .time-long[data-v-4f35e31c]{min-width:%?72?%;height:%?30?%;padding:0 %?5?%;background:linear-gradient(270deg,#4c545a,#282b34);border-radius:%?4?%;font-size:%?20?%;color:#ffeeb9;margin-right:%?16?%}.pages-user-bell .list-item .f-icontext[data-v-4f35e31c]{font-size:%?18?%}.pages-user-bell .list-item .text-delete[data-v-4f35e31c]{font-size:%?20?%;color:#b9b9b9}.pages-user-bell .list-item .remove-btn[data-v-4f35e31c]{width:%?110?%;height:%?54?%;-webkit-transform:rotate(1turn);transform:rotate(1turn)}.pages-user-bell .list-item .shengji-icon-text[data-v-4f35e31c]{height:%?60?%}.pages-user-bell .change-btn[data-v-4f35e31c]{width:%?125?%;height:%?46?%;font-size:%?20?%;-webkit-transform:rotate(1turn);transform:rotate(1turn)}.pages-user-bell .change-btn .iconfont[data-v-4f35e31c]{font-size:%?20?%;-webkit-transform:scale(.8);transform:scale(.8)}',""]),e.exports=t},fb22:function(e,t,i){"use strict";i("7a82");var n=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("d81d"),i("14d9"),i("caad"),i("2532"),i("c740"),i("4de4"),i("d3b7"),i("a434");var a=n(i("c7eb")),s=n(i("1da1")),r=n(i("5530")),c=i("26cb"),o={components:{},data:function(){return{isLoad:!1,options:{},navTitle:"",tabList:[{id:1,title:"项目升级"},{id:2,title:"项目加钟"}],activeIndex:0,serviceList:[],serviceList_check:[],no_check_id:0,have_check:[],have_check_num:0,have_all_check:!1,can_add_order:0,order_goods:[],order_uprecord:[],goodsInd:0,showGoods:!1,loading:!0,popupInfo:{},lockTap:!1}},computed:(0,c.mapState)({primaryColor:function(e){return e.config.configInfo.primaryColor},subColor:function(e){return e.config.configInfo.subColor},configInfo:function(e){return e.config.configInfo},userInfo:function(e){return e.user.userInfo},carList:function(e){return e.order.carList}}),onLoad:function(e){this.options=e;var t=e.tab,i=void 0===t?0:t;this.activeIndex=i,this.initIndex()},watch:{have_check:function(e){0==this.activeIndex&&this.toFormatHaveCheck()}},filters:{textFormat:function(e){var t=e;return e.length>5&&(t=e.substring(0,5)+"..."),t}},methods:(0,r.default)((0,r.default)((0,r.default)({},(0,c.mapActions)(["getCarList"])),(0,c.mapMutations)(["updateOrderItem"])),{},{initIndex:function(){var e=arguments,t=this;return(0,s.default)((0,a.default)().mark((function i(){var n;return(0,a.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.length>0&&void 0!==e[0]&&e[0],n||!t.$jweixin.isWechat()){i.next=5;break}return i.next=4,t.$jweixin.initJssdk();case 4:t.$jweixin.wxReady((function(){t.$jweixin.hideOptionMenu()}));case 5:return i.next=7,t.getDetail();case 7:return i.next=9,t.getList();case 9:uni.setNavigationBarTitle({title:t.navTitle}),t.isLoad=!0,t.$util.setNavigationBarColor({bg:t.primaryColor});case 12:case"end":return i.stop()}}),i)})))()},initRefresh:function(){this.initIndex(!0)},getDetail:function(){var e=this;return(0,s.default)((0,a.default)().mark((function t(){var i,n,s,r;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.options.id,t.next=3,e.$api.order.orderInfo({id:i});case 3:n=t.sent,s=n.order_goods,r=n.can_add_order,e.order_goods=s,e.can_add_order=r,e.navTitle=r?"升级/加钟":"升级项目";case 9:case"end":return t.stop()}}),t)})))()},getList:function(){var e=this;return(0,s.default)((0,a.default)().mark((function t(){var i,n,s,r,c,o,l,d,u,v,f;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.options,n=i.id,s=i.coach_id,r=e.order_goods[e.goodsInd],c=r.id,o=r.true_price,t.next=4,e.getCarList({coach_id:s,order_id:n});case 4:return l=e.activeIndex,d=0===l?"getUpOrderGoods":"coachServiceList",u=0===l?{order_goods_id:c}:{coach_id:s,is_add:1},t.next=9,e.$api.service[d](u);case 9:return v=t.sent,1==l&&(v=v.data),f=[],e.carList.list.map((function(e){f.push(e.service_id)})),v.map((function(t){if(t.is_check=!1,0==l&&(t.init_add_num=1,t.init_add_price=(t.price-o).toFixed(2),t.is_check=e.serviceList_check.includes(t.id)),f.includes(t.id)){var i=f.findIndex((function(e){return e==t.id}));t.num=e.carList.list[i].num,t.cart_id=e.carList.list[i].id,t.is_check=!0}})),e.serviceList=v,t.next=17,e.toFormatHaveCheck(3);case 17:e.loading=!1,e.$util.hideAll();case 19:case"end":return t.stop()}}),t)})))()},handerTabChange:function(e){this.activeIndex=e,this.serviceList=[],this.getList()},toChangeGoods:function(e){var t=this;return(0,s.default)((0,a.default)().mark((function i(){return(0,a.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.goodsInd=e,t.showGoods=!1,i.next=4,t.toFormatHaveCheck(2);case 4:t.handerTabChange(0);case 5:case"end":return i.stop()}}),i)})))()},toFormatHaveCheck:function(){var e=arguments,t=this;return(0,s.default)((0,a.default)().mark((function i(){var n,s,r,c,o;return(0,a.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:n=e.length>0&&void 0!==e[0]?e[0]:1,s=t.order_goods[t.goodsInd].id,3!=n&&(r=t.have_check.filter((function(e){return e.order_goods_id==s})),t.have_all_check=r.length==t.serviceList.length,t.serviceList_check=r.map((function(e){return e.id})),c=0,r.map((function(e){c+=e.init_add_num})),t.have_check_num=c),2!=n&&(o=t.serviceList.filter((function(e){return!e.is_check})),t.no_check_id=o.length>0?o[0].id:0);case 4:case"end":return i.stop()}}),i)})))()},changeNum:function(e,t){var i=this;return(0,s.default)((0,a.default)().mark((function n(){var s,r,c,o,l;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(s=i.$util.deepCopy(i.have_check),r=s[t].init_add_num,c=i.order_goods[i.goodsInd].num,o=i.have_check_num,l=r+e,!(o+e>c)&&l){n.next=8;break}return i.$util.showToast({title:l?"数量不可大于".concat(r):"数量至少为1"}),n.abrupt("return");case 8:s[t].init_add_num=l,i.have_check=s;case 10:case"end":return n.stop()}}),n)})))()},toAddDelItem:function(e,t){var i=this;return(0,s.default)((0,a.default)().mark((function n(){var s,r,c,o,l,d,u,v,f,h,p,_,g,m,x,w,b,C,k,y,I,L,$,T;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(s=i.activeIndex,r=i.have_check_num,0!=s){n.next=8;break}if(c=i.order_goods[i.goodsInd],o=c.id,l=c.num,d=c.goods_name,1!=e||r!=l){n.next=6;break}return i.$util.showToast({title:"当前项目最多可升级".concat(l,"个服务数量")}),n.abrupt("return");case 6:return 1==e?(i.serviceList[t].order_goods_id=o,i.serviceList[t].order_goods_name=d,i.serviceList[t].is_check=!0,i.have_check.push(i.serviceList[t])):(u=i.have_check[t],v=u.id,f=u.order_goods_id,i.have_check.splice(t,1),o==f&&(h=i.serviceList.findIndex((function(e){return e.id===v})),i.serviceList[h].is_check=!1)),n.abrupt("return");case 8:if(p=i.options,_=p.id,g=p.coach_id,m=i.serviceList[t],x=m.id,w=m.is_check,b=void 0!==w&&w,C=m.num,void 0===C?0:C,k=m.cart_id,y=void 0===k?0:k,I=!b,!i.lockTap){n.next=13;break}return n.abrupt("return");case 13:return i.lockTap=!0,L=I?"addCar":"delCar",$=I?{service_id:x,coach_id:g,order_id:_,num:1}:{id:y,num:1},n.prev=16,n.next=19,i.$api.order[L]($);case 19:return T=n.sent,i.serviceList.map((function(e){e.is_check=!1})),i.serviceList[t].is_check=I,i.serviceList[t].num=I?1:0,T&&I&&!y&&(i.serviceList[t].cart_id=T),i.serviceList[t].num<1&&(i.serviceList[t].cart_id=0),n.next=27,i.getCarList({coach_id:g,order_id:_});case 27:i.lockTap=!1,n.next=33;break;case 30:n.prev=30,n.t0=n["catch"](16),i.lockTap=!1;case 33:case"end":return n.stop()}}),n,null,[[16,30]])})))()},toOrder:function(){var e=this.have_check,t=this.activeIndex,i=this.carList;if(0==t&&0==e.length||1==t&&i.car_count<1){var n=0==t?"升级":"加钟";this.$util.showToast({title:"请选择".concat(n,"服务")})}else{var a=this.options,s=a.id,r=a.coach_id,c={order_type:t};if(0==t){var o=e.map((function(e){return{order_goods_id:e.order_goods_id,service_id:e.id,num:e.init_add_num}}));c=Object.assign({},c,{order_id:s,order_goods:o})}else c=Object.assign({},c,{coach_id:r,order_id:s});this.updateOrderItem({key:"bellOrderParams",val:c}),this.$util.goUrl({url:"/user/pages/bell/order",openType:"redirectTo"})}}})};t.default=o}}]);